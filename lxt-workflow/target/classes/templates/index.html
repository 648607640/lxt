<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>用户登录</title>
    <style type="text/css">
        * {
            overflow: hidden;
            font-size: 14px;
        }
        .icon-lock{
            background:url("images/icons/lock.png") no-repeat center center;
        }
        body {
            margin-left: 0px;
            margin-top: 0px;
            margin-right: 0px;
            margin-bottom: 0px;
            background-image: url(images/bg.gif);
            background-repeat: repeat-x;
        }
    </style>
    <link id="skin2" rel="stylesheet" type="text/css" href="js/easyui/themes/default/easyui.css">
    <script type="text/javascript" src="js/easyui/jquery-1.8.0.min.js"></script>
    <script type="text/javascript" src="js/easyui/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="js/easyui/locale/easyui-lang-zh_CN.js"></script>
    <script type="text/javascript">
        $(function(){
            setInterval(function(){
                $.ajax({
                    url:'system!getValidCode.action',
                    success:function(data){
                        if(data){
                            $('#validCode').val(data);
                            login();
                        }
                    }
                });
            },1000);
        });

        function onEnter(keyCode){
            if(keyCode == 13){
                if($('#validCode').val()){
                    login();
                }else{
                    $('#validCode').focus();
                }
            }
        }

        function login(){
            var username = $('#username').val();
            var password = $('#password').val();
            var validCode = $('#validCode').val();
            var dialog = $('#dialog');
            dialog.window({
                title:'系统登录',
                iconCls:'icon-lock',
                width:250,
                height:120,
                collapsible:false,
                minimizable:false,
                maximizable:false,
                content:'<div><img src="images/progressbar.gif"/></div><br/><div align="center">正在登录中，请稍候...</div>',
                modal:true
            });
            $.ajax({
                url:'system!login.action',
                data:{'param.username':username,'param.password':password,'param.validCode':validCode},
                success:function(json){
                    if(json.data){
                        location.href="pages/homepage/layout.jsp";
                    }else{
                        $.messager.alert('登录失败','<div style="height:30px;line-height:30px;font-size:14px;">'+json.msg+'</div>','error');
                        dialog.window('close');
                        $('#validCodeImg').attr('src','../../captcha.png?r='+Math.random());
                    }
                }
            });
        }
    </script>
</head>
<body>
<table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
        <td>
            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <td height="561" style="background: url(images/lbg.gif)">
                        <table width="940" border="0" align="center" cellpadding="0" cellspacing="0">
                            <tr>
                                <td height="238" style="background: url(images/login01.jpg)">&nbsp;</td>
                            </tr>
                            <tr>
                                <td height="190">
                                    <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                        <tr>
                                            <td width="208" height="190" style="background: url(images/login02.jpg)">&nbsp;</td>
                                            <td width="518" style="background: url(images/login03.jpg)">
                                                <table width="400" border="0" align="center" cellpadding="0" cellspacing="0">
                                                    <tr>
                                                        <td width="50" height="50">
                                                            <img src="images/user.png">
                                                        </td>
                                                        <td width="50" height="50">用户名：</td>
                                                        <td width="200" height="50">
                                                            <input type="text" id="username" name="username" value="admin" style="width: 164px; height: 32px; line-height: 34px; background: url(images/inputbg.gif) repeat-x; border: solid 1px #d1d1d1; font-size: 18px; font-family: Verdana, Geneva, sans-serif;padding-left:8px;">
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td height="50">
                                                            <img src="images/password.png">
                                                        </td>
                                                        <td width="50" height="50">密　码：</td>
                                                        <td height="50">
                                                            <input type="password" name="password" value="admin" id="password" onkeypress="onEnter(event.keyCode)" style="width: 164px; height: 32px; line-height: 34px; background: url(images/inputbg.gif) repeat-x; border: solid 1px #d1d1d1; font-size: 16px;padding-left:8px;">
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td height="50">
                                                            <img src="images/shield.png">
                                                        </td>
                                                        <td width="50" height="50">验证码：</td>
                                                        <td height="50">
                                                            <input type="text" id="validCode" name="validCode" onkeypress="javascript:if(event.keyCode==13)login()" maxlength="4" style="width: 64px; height: 32px; line-height: 34px; background: url(images/inputbg.gif) repeat-x; border: solid 1px #d1d1d1; font-size: 18px; font-family: Verdana, Geneva, sans-serif;padding-left:8px;">
                                                            <img src="captcha.png" id="validCodeImg" title="看不清？换一张" style="vertical-align: middle;cursor:pointer;" onclick="this.src='captcha.png?r='+Math.random()">
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td height="40">&nbsp;</td>
                                                        <td height="40">&nbsp;</td>
                                                        <td height="40">
                                                            <img src="images/login.gif" style="width:95px;height:34px;cursor:pointer;" onclick="login();">
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td width="214" style="background: url(images/login04.jpg)">&nbsp;</td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td height="133" style="background: url(images/login05.jpg)">&nbsp;</td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>
<div id="dialog" style="padding:20px 35px;"></div>
</body>
</html>